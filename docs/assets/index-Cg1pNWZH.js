const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-Bg-kAULK.js","assets/colorToUniform-httQlrui.js","assets/FederatedEventTarget-ByTUhKVr.js","assets/CanvasTextSystem-DeelqNQp.js","assets/CanvasPool-BFR4Yd26.js","assets/init-Cqxz7Obj.js","assets/webworkerAll-CJZMYJJw.js","assets/WebGPURenderer-BXRBg-MN.js","assets/SharedSystems-DRLLp05R.js","assets/WebGPURenderer-Bv3e1YDF.js","assets/WebGLRenderer-DcNCdUVf.js","assets/WebGLRenderer-CL2-buce.js"])))=>i.map(i=>d[i]);
import{B as e,Et as t,R as n,Tt as r,V as i,bt as a,ct as o,ft as s,gt as c,ht as l,it as u,wt as d,yt as f,z as p}from"./colorToUniform-httQlrui.js";import{A as m,D as h,E as ee,M as te,N as g,O as _,T as v,_ as ne,b as re,f as y,g as b,j as x,k as S,p as ie,v as ae,w as oe,x as se}from"./CanvasTextSystem-DeelqNQp.js";import"./FederatedEventTarget-ByTUhKVr.js";import{h as ce,m as le}from"./SharedSystems-DRLLp05R.js";import"./CanvasPool-BFR4Yd26.js";import"./WebGLRenderer-CL2-buce.js";import"./WebGPURenderer-Bv3e1YDF.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var ue=`modulepreload`,de=function(e){return`/`+e},fe={};const C=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=document.getElementsByTagName(`link`),i=document.querySelector(`meta[property=csp-nonce]`),a=i?.nonce||i?.getAttribute(`nonce`);function o(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:`fulfilled`,value:e}),e=>({status:`rejected`,reason:e}))))}r=o(t.map(t=>{if(t=de(t,n),t in fe)return;fe[t]=!0;let r=t.endsWith(`.css`),i=r?`[rel="stylesheet"]`:``;if(n)for(let n=e.length-1;n>=0;n--){let i=e[n];if(i.href===t&&(!r||i.rel===`stylesheet`))return}else if(document.querySelector(`link[href="${t}"]${i}`))return;let o=document.createElement(`link`);if(o.rel=r?`stylesheet`:ue,r||(o.as=`script`),o.crossOrigin=``,o.href=t,a&&o.setAttribute(`nonce`,a),document.head.appendChild(o),r)return new Promise((e,n)=>{o.addEventListener(`load`,e),o.addEventListener(`error`,()=>n(Error(`Unable to preload CSS for ${t}`)))})}))}function i(e){let t=new Event(`vite:preloadError`,{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(let e of t||[])e.status===`rejected`&&i(e.reason);return e().catch(i)})};var pe={extension:{type:r.Environment,name:`browser`,priority:-1},test:()=>!0,load:async()=>{await C(()=>import(`./browserAll-Bg-kAULK.js`),__vite__mapDeps([0,1,2,3,4,5]))}},me={extension:{type:r.Environment,name:`webworker`,priority:0},test:()=>typeof self<`u`&&self.WorkerGlobalScope!==void 0,load:async()=>{await C(()=>import(`./webworkerAll-CJZMYJJw.js`),__vite__mapDeps([6,1,3,4,5]))}},w;function he(e){return w===void 0&&(w=(()=>{let t={stencil:!0,failIfMajorPerformanceCaveat:e??ce.defaultOptions.failIfMajorPerformanceCaveat};try{if(!n.get().getWebGLRenderingContext())return!1;let e=n.get().createCanvas().getContext(`webgl`,t),r=!!e?.getContextAttributes()?.stencil;if(e){let t=e.getExtension(`WEBGL_lose_context`);t&&t.loseContext()}return e=null,r}catch{return!1}})()),w}var T;async function ge(e={}){return T===void 0&&(T=await(async()=>{let t=n.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(e)).requestDevice(),!0}catch{return!1}})()),T}var E=[`webgl`,`webgpu`,`canvas`];async function _e(e){let t=[];e.preference?(t.push(e.preference),E.forEach(n=>{n!==e.preference&&t.push(n)})):t=E.slice();let n,r={};for(let i=0;i<t.length;i++){let a=t[i];if(a===`webgpu`&&await ge()){let{WebGPURenderer:t}=await C(async()=>{let{WebGPURenderer:e}=await import(`./WebGPURenderer-BXRBg-MN.js`);return{WebGPURenderer:e}},__vite__mapDeps([7,1,8,9,4]));n=t,r={...e,...e.webgpu};break}else if(a===`webgl`&&he(e.failIfMajorPerformanceCaveat??ce.defaultOptions.failIfMajorPerformanceCaveat)){let{WebGLRenderer:t}=await C(async()=>{let{WebGLRenderer:e}=await import(`./WebGLRenderer-DcNCdUVf.js`);return{WebGLRenderer:e}},__vite__mapDeps([10,1,8,11]));n=t,r={...e,...e.webgl};break}else if(a===`canvas`)throw r={...e},Error(`CanvasRenderer is not yet implemented`)}if(delete r.webgpu,delete r.webgl,!n)throw Error(`No available renderer for the current environment`);let i=new n;return await i.init(r),i}var D=class e{constructor(...e){this.stage=new i,e[0]!==void 0&&l(c,`Application constructor options are deprecated, please use Application.init() instead.`)}async init(t){t={...t},this.stage||=new i,this.renderer=await _e(t),e._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return l(c,`Application.view is deprecated, please use Application.canvas instead.`),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,n=!1){let r=e._plugins.slice(0);r.reverse(),r.forEach(e=>{e.destroy.call(this)}),this.stage.destroy(n),this.stage=null,this.renderer.destroy(t),this.renderer=null}};D._plugins=[];var O=D;t.handleByList(r.Application,O._plugins),t.add(le);var k=class extends se{constructor(e,t){super();let{textures:n,data:r}=e;Object.keys(r.pages).forEach(e=>{let t=n[r.pages[parseInt(e,10)].id];this.pages.push({texture:t})}),Object.keys(r.chars).forEach(e=>{let t=r.chars[e],{frame:i,source:s,rotate:c}=n[t.page],l=new o({frame:a.transformRectCoords(t,i,c,new f),orig:new f(0,0,t.width,t.height),source:s,rotate:c});this.chars[e]={id:e.codePointAt(0),xOffset:t.xOffset,yOffset:t.yOffset,xAdvance:t.xAdvance,kerning:t.kerning??{},texture:l}}),this.baseRenderedFontSize=r.fontSize,this.baseMeasurementFontSize=r.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:r.fontSize},this.baseLineOffset=r.baseLineOffset,this.lineHeight=r.lineHeight,this.fontFamily=r.fontFamily,this.distanceField=r.distanceField??{type:`none`,range:0},this.url=t}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){let{texture:t}=this.pages[e];t.destroy(!0)}this.pages=null}static install(e){b.install(e)}static uninstall(e){b.uninstall(e)}},A={test(e){return typeof e==`string`&&e.startsWith(`info face=`)},parse(e){let t=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let e in t){let r=t[e].match(/^[a-z]+/gm)[0],i=t[e].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(let e in i){let t=i[e].split(`=`),n=t[0],r=t[1].replace(/"/gm,``),o=parseFloat(r);a[n]=isNaN(o)?r:o}n[r].push(a)}let r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:``,distanceField:null,baseLineOffset:0},[i]=n.info,[a]=n.common,[o]=n.distanceField??[];o&&(r.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),r.fontSize=parseInt(i.size,10),r.fontFamily=i.face,r.lineHeight=parseInt(a.lineHeight,10);let s=n.page;for(let e=0;e<s.length;e++)r.pages.push({id:parseInt(s[e].id,10)||0,file:s[e].file});let c={};r.baseLineOffset=r.lineHeight-parseInt(a.base,10);let l=n.char;for(let e=0;e<l.length;e++){let t=l[e],n=parseInt(t.id,10),i=t.letter??t.char??String.fromCharCode(n);i===`space`&&(i=` `),c[n]=i,r.chars[i]={id:n,page:parseInt(t.page,10)||0,x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xOffset:parseInt(t.xoffset,10),yOffset:parseInt(t.yoffset,10),xAdvance:parseInt(t.xadvance,10),kerning:{}}}let u=n.kerning||[];for(let e=0;e<u.length;e++){let t=parseInt(u[e].first,10),n=parseInt(u[e].second,10),i=parseInt(u[e].amount,10);r.chars[c[n]].kerning[c[t]]=i}return r}},j={test(e){let t=e;return typeof t!=`string`&&`getElementsByTagName`in t&&t.getElementsByTagName(`page`).length&&t.getElementsByTagName(`info`)[0].getAttribute(`face`)!==null},parse(e){let t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:``,distanceField:null,baseLineOffset:0},n=e.getElementsByTagName(`info`)[0],r=e.getElementsByTagName(`common`)[0],i=e.getElementsByTagName(`distanceField`)[0];i&&(t.distanceField={type:i.getAttribute(`fieldType`),range:parseInt(i.getAttribute(`distanceRange`),10)});let a=e.getElementsByTagName(`page`),o=e.getElementsByTagName(`char`),s=e.getElementsByTagName(`kerning`);t.fontSize=parseInt(n.getAttribute(`size`),10),t.fontFamily=n.getAttribute(`face`),t.lineHeight=parseInt(r.getAttribute(`lineHeight`),10);for(let e=0;e<a.length;e++)t.pages.push({id:parseInt(a[e].getAttribute(`id`),10)||0,file:a[e].getAttribute(`file`)});let c={};t.baseLineOffset=t.lineHeight-parseInt(r.getAttribute(`base`),10);for(let e=0;e<o.length;e++){let n=o[e],r=parseInt(n.getAttribute(`id`),10),i=n.getAttribute(`letter`)??n.getAttribute(`char`)??String.fromCharCode(r);i===`space`&&(i=` `),c[r]=i,t.chars[i]={id:r,page:parseInt(n.getAttribute(`page`),10)||0,x:parseInt(n.getAttribute(`x`),10),y:parseInt(n.getAttribute(`y`),10),width:parseInt(n.getAttribute(`width`),10),height:parseInt(n.getAttribute(`height`),10),xOffset:parseInt(n.getAttribute(`xoffset`),10),yOffset:parseInt(n.getAttribute(`yoffset`),10),xAdvance:parseInt(n.getAttribute(`xadvance`),10),kerning:{}}}for(let e=0;e<s.length;e++){let n=parseInt(s[e].getAttribute(`first`),10),r=parseInt(s[e].getAttribute(`second`),10),i=parseInt(s[e].getAttribute(`amount`),10);t.chars[c[r]].kerning[c[n]]=i}return t}},M={test(e){return typeof e==`string`&&e.match(/<font(\s|>)/)?j.test(n.get().parseXML(e)):!1},parse(e){return j.parse(n.get().parseXML(e))}},ve=[`.xml`,`.fnt`],ye={extension:{type:r.CacheParser,name:`cacheBitmapFont`},test:e=>e instanceof k,getCacheableAssets(e,t){let n={};return e.forEach(e=>{n[e]=t,n[`${e}-bitmap`]=t}),n[`${t.fontFamily}-bitmap`]=t,n}},be={extension:{type:r.LoadParser,priority:_.Normal},name:`loadBitmapFont`,id:`bitmap-font`,test(e){return ve.includes(h.extname(e).toLowerCase())},async testParse(e){return A.test(e)||M.test(e)},async parse(e,t,n){let r=A.test(e)?A.parse(e):M.parse(e),{src:i}=t,{pages:a}=r,o=[],s=r.distanceField?{scaleMode:`linear`,alphaMode:`premultiply-alpha-on-upload`,autoGenerateMipmaps:!1,resolution:1}:{};for(let e=0;e<a.length;++e){let t=a[e].file,n=h.join(h.dirname(i),t);n=oe(n,i),o.push({src:n,data:s})}let c=await n.load(o);return new k({data:r,textures:o.map(e=>c[e.src])},i)},async load(e,t){return await(await n.get().fetch(e)).text()},async unload(e,t,n){await Promise.all(e.pages.map(e=>n.unload(e.texture.source._sourceOrigin))),e.destroy()}},xe=class{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log(`[BackgroundLoader] assets: `,this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<t;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}},Se={extension:{type:r.CacheParser,name:`cacheTextureArray`},test:e=>Array.isArray(e)&&e.every(e=>e instanceof o),getCacheableAssets:(e,t)=>{let n={};return e.forEach(e=>{t.forEach((t,r)=>{n[e+(r===0?``:r+1)]=t})}),n}};async function N(e){if(`Image`in globalThis)return new Promise(t=>{let n=new Image;n.onload=()=>{t(!0)},n.onerror=()=>{t(!1)},n.src=e});if(`createImageBitmap`in globalThis&&`fetch`in globalThis){try{let t=await(await fetch(e)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}var Ce={extension:{type:r.DetectionParser,priority:1},test:async()=>N(`data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=`),add:async e=>[...e,`avif`],remove:async e=>e.filter(e=>e!==`avif`)},P=[`png`,`jpg`,`jpeg`],we={extension:{type:r.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...P],remove:async e=>e.filter(e=>!P.includes(e))},Te=`WorkerGlobalScope`in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function F(e){return Te?!1:document.createElement(`video`).canPlayType(e)!==``}var Ee={extension:{type:r.DetectionParser,priority:0},test:async()=>F(`video/mp4`),add:async e=>[...e,`mp4`,`m4v`],remove:async e=>e.filter(e=>e!==`mp4`&&e!==`m4v`)},De={extension:{type:r.DetectionParser,priority:0},test:async()=>F(`video/ogg`),add:async e=>[...e,`ogv`],remove:async e=>e.filter(e=>e!==`ogv`)},Oe={extension:{type:r.DetectionParser,priority:0},test:async()=>F(`video/webm`),add:async e=>[...e,`webm`],remove:async e=>e.filter(e=>e!==`webm`)},ke={extension:{type:r.DetectionParser,priority:0},test:async()=>N(`data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=`),add:async e=>[...e,`webp`],remove:async e=>e.filter(e=>e!==`webp`)},I=class e{constructor(){this.loadOptions={...e.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,n)=>(this._parsersValidated=!1,e[t]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){let n={promise:null,parser:null};return n.promise=(async()=>{let r=null,i=null;if((t.parser||t.loadParser)&&(i=this._parserHash[t.parser||t.loadParser],t.loadParser&&u(`[Assets] "loadParser" is deprecated, use "parser" instead for ${e}`),i||u(`[Assets] specified load parser "${t.parser||t.loadParser}" not found while loading ${e}`)),!i){for(let n=0;n<this.parsers.length;n++){let r=this.parsers[n];if(r.load&&r.test?.(e,t,this)){i=r;break}}if(!i)return u(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await i.load(e,t,this),n.parser=i;for(let e=0;e<this.parsers.length;e++){let i=this.parsers[e];i.parse&&i.parse&&await i.testParse?.(r,t,this)&&(r=await i.parse(r,t,this)||r,n.parser=i)}return r})(),n}async load(t,n){this._parsersValidated||this._validateParsers();let{onProgress:r,onError:i,strategy:a,retryCount:o,retryDelay:s}=typeof n==`function`?{...e.defaultOptions,...this.loadOptions,onProgress:n}:{...e.defaultOptions,...this.loadOptions,...n||{}},c=0,l={},u=ee(t),d=m(t,e=>({alias:[e],src:e,data:{}})),f=d.reduce((e,t)=>e+(t.progressSize||1),0),p=d.map(async e=>{let t=h.toAbsolute(e.src);l[e.src]||(await this._loadAssetWithRetry(t,e,{onProgress:r,onError:i,strategy:a,retryCount:o,retryDelay:s},l),c+=e.progressSize||1,r&&r(c/f))});return await Promise.all(p),u?l[d[0].src]:l}async unload(e){let t=m(e,e=>({alias:[e],src:e})).map(async e=>{let t=h.toAbsolute(e.src),n=this.promiseCache[t];if(n){let r=await n.promise;delete this.promiseCache[t],await n.parser?.unload?.(r,e,this)}});await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name||e.id).reduce((e,t)=>(!t.name&&!t.id?u(`[Assets] parser should have an id`):(e[t.name]||e[t.id])&&u(`[Assets] parser id conflict "${t.id}"`),e[t.name]=t,t.id&&(e[t.id]=t),e),{})}async _loadAssetWithRetry(e,t,n,r){let i=0,{onError:a,strategy:o,retryCount:s,retryDelay:c}=n,l=e=>new Promise(t=>setTimeout(t,e));for(;;)try{this.promiseCache[e]||(this.promiseCache[e]=this._getLoadPromiseAndParser(e,t)),r[t.src]=await this.promiseCache[e].promise;return}catch(n){if(delete this.promiseCache[e],delete r[t.src],i++,o===`retry`&&!(o!==`retry`||i>s)){a&&a(n,t),await l(c);continue}if(o===`skip`){a&&a(n,t);return}throw a&&a(n,t),Error(`[Loader.load] Failed to load ${e}.
${n}`)}}};I.defaultOptions={onProgress:void 0,onError:void 0,strategy:`throw`,retryCount:3,retryDelay:250};var Ae=I;function L(e,t){if(Array.isArray(t)){for(let n of t)if(e.startsWith(`data:${n}`))return!0;return!1}return e.startsWith(`data:${t}`)}function R(e,t){let n=e.split(`?`)[0],r=h.extname(n).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}var je=`.json`,Me=`application/json`,Ne={extension:{type:r.LoadParser,priority:_.Low},name:`loadJson`,id:`json`,test(e){return L(e,Me)||R(e,je)},async load(e){return await(await n.get().fetch(e)).json()}},Pe=`.txt`,Fe=`text/plain`,Ie={name:`loadTxt`,id:`text`,extension:{type:r.LoadParser,priority:_.Low,name:`loadTxt`},test(e){return L(e,Fe)||R(e,Pe)},async load(e){return await(await n.get().fetch(e)).text()}},Le=[`normal`,`bold`,`100`,`200`,`300`,`400`,`500`,`600`,`700`,`800`,`900`],Re=[`.ttf`,`.otf`,`.woff`,`.woff2`],ze=[`font/ttf`,`font/otf`,`font/woff`,`font/woff2`],Be=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Ve(e){let t=h.extname(e),n=h.basename(e,t).replace(/(-|_)/g,` `).toLowerCase().split(` `).map(e=>e.charAt(0).toUpperCase()+e.slice(1)),r=n.length>0;for(let e of n)if(!e.match(Be)){r=!1;break}let i=n.join(` `);return r||(i=`"${i.replace(/[\\"]/g,`\\$&`)}"`),i}var He=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Ue(e){return He.test(e)?e:encodeURI(e)}var We={extension:{type:r.LoadParser,priority:_.Low},name:`loadWebFont`,id:`web-font`,test(e){return L(e,ze)||R(e,Re)},async load(e,t){let r=n.get().getFontFaceSet();if(r){let n=[],i=t.data?.family??Ve(e),a=t.data?.weights?.filter(e=>Le.includes(e))??[`normal`],o=t.data??{};for(let t=0;t<a.length;t++){let s=a[t],c=new FontFace(i,`url(${Ue(e)})`,{...o,weight:s});await c.load(),r.add(c),n.push(c)}return S.has(`${i}-and-url`)?S.get(`${i}-and-url`).entries.push({url:e,faces:n}):S.set(`${i}-and-url`,{entries:[{url:e,faces:n}]}),n.length===1?n[0]:n}return u(`[loadWebFont] FontFace API is not supported. Skipping loading font`),null},unload(e){let t=Array.isArray(e)?e:[e],r=t[0].family,i=S.get(`${r}-and-url`),a=i.entries.find(e=>e.faces.some(e=>t.indexOf(e)!==-1));a.faces=a.faces.filter(e=>t.indexOf(e)===-1),a.faces.length===0&&(i.entries=i.entries.filter(e=>e!==a)),t.forEach(e=>{n.get().getFontFaceSet().delete(e)}),i.entries.length===0&&S.remove(`${r}-and-url`)}};function z(e,t=1){let n=v.RETINA_PREFIX?.exec(e);return n?parseFloat(n[1]):t}function B(e,t,n){e.label=n,e._sourceOrigin=n;let r=new o({source:e,label:n}),i=()=>{delete t.promiseCache[n],S.has(n)&&S.remove(n)};return r.source.once(`destroy`,()=>{t.promiseCache[n]&&(u(`[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource.`),i())}),r.once(`destroy`,()=>{e.destroyed||(u(`[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture.`),i())}),r}var Ge=`.svg`,Ke=`image/svg+xml`,qe={extension:{type:r.LoadParser,priority:_.Low,name:`loadSVG`},name:`loadSVG`,id:`svg`,config:{crossOrigin:`anonymous`,parseAsGraphicsContext:!1},test(e){return L(e,Ke)||R(e,Ge)},async load(e,t,n){return t.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?Ye(e):Je(e,t,n,this.config.crossOrigin)},unload(e){e.destroy(!0)}};async function Je(e,t,r,i){let a=await n.get().fetch(e),o=n.get().createImage();o.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await a.text())}`,o.crossOrigin=i,await o.decode();let s=t.data?.width??o.width,c=t.data?.height??o.height,l=t.data?.resolution||z(e),u=Math.ceil(s*l),d=Math.ceil(c*l),f=n.get().createCanvas(u,d),p=f.getContext(`2d`);p.imageSmoothingEnabled=!0,p.imageSmoothingQuality=`high`,p.drawImage(o,0,0,s*l,c*l);let{parseAsGraphicsContext:m,...h}=t.data??{};return B(new g({resource:f,alphaMode:`premultiply-alpha-on-upload`,resolution:l,...h}),r,e)}async function Ye(e){let t=await(await n.get().fetch(e)).text(),r=new ae;return r.svg(t),r}var Xe=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`,V=null,H=class{constructor(){V||=URL.createObjectURL(new Blob([Xe],{type:`application/javascript`})),this.worker=new Worker(V)}};H.revokeObjectURL=function(){V&&=(URL.revokeObjectURL(V),null)};var Ze=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`,U=null,Qe=class{constructor(){U||=URL.createObjectURL(new Blob([Ze],{type:`application/javascript`})),this.worker=new Worker(U)}};Qe.revokeObjectURL=function(){U&&=(URL.revokeObjectURL(U),null)};var $e=0,W,et=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported===void 0&&(this._isImageBitmapSupported=new Promise(e=>{let{worker:t}=new H;t.addEventListener(`message`,n=>{t.terminate(),H.revokeObjectURL(),e(n.data)})})),this._isImageBitmapSupported}loadImageBitmap(e,t){return this._run(`loadImageBitmap`,[e,t?.data?.alphaMode])}async _initWorkers(){this._initialized||=!0}_getWorker(){W===void 0&&(W=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<W&&(this._createdWorkers++,e=new Qe().worker,e.addEventListener(`message`,e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){this._resolveHash[e.uuid]&&(e.error===void 0?this._resolveHash[e.uuid].resolve(e.data):this._resolveHash[e.uuid].reject(e.error),delete this._resolveHash[e.uuid])}async _run(e,t){await this._initWorkers();let n=new Promise((n,r)=>{this._queue.push({id:e,arguments:t,resolve:n,reject:r})});return this._next(),n}_next(){if(!this._queue.length)return;let e=this._getWorker();if(!e)return;let t=this._queue.pop(),n=t.id;this._resolveHash[$e]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:$e++,id:n})}reset(){this._workerPool.forEach(e=>e.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:e})=>{e?.(Error(`WorkerManager has been reset before completion`))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}},tt=[`.jpeg`,`.jpg`,`.png`,`.webp`,`.avif`],nt=[`image/jpeg`,`image/png`,`image/webp`,`image/avif`];async function rt(e,t){let r=await n.get().fetch(e);if(!r.ok)throw Error(`[loadImageBitmap] Failed to fetch ${e}: ${r.status} ${r.statusText}`);let i=await r.blob();return t?.data?.alphaMode===`premultiplied-alpha`?createImageBitmap(i,{premultiplyAlpha:`none`}):createImageBitmap(i)}var it={name:`loadTextures`,id:`texture`,extension:{type:r.LoadParser,priority:_.High,name:`loadTextures`},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:`anonymous`},test(e){return L(e,nt)||R(e,tt)},async load(e,t,r){let i=null;return i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await et.isImageBitmapSupported()?await et.loadImageBitmap(e,t):await rt(e,t):await new Promise((t,r)=>{i=n.get().createImage(),i.crossOrigin=this.config.crossOrigin,i.src=e,i.complete?t(i):(i.onload=()=>{t(i)},i.onerror=r)}),B(new g({resource:i,alphaMode:`premultiply-alpha-on-upload`,resolution:t.data?.resolution||z(e),...t.data}),r,e)},unload(e){e.destroy(!0)}},at=[`.mp4`,`.m4v`,`.webm`,`.ogg`,`.ogv`,`.h264`,`.avi`,`.mov`],G,K;function ot(e,t,n){n===void 0&&!t.startsWith(`data:`)?e.crossOrigin=ct(t):n!==!1&&(e.crossOrigin=typeof n==`string`?n:`anonymous`)}function st(e){return new Promise((t,n)=>{e.addEventListener(`canplaythrough`,r),e.addEventListener(`error`,i),e.load();function r(){a(),t()}function i(e){a(),n(e)}function a(){e.removeEventListener(`canplaythrough`,r),e.removeEventListener(`error`,i)}})}function ct(e,t=globalThis.location){if(e.startsWith(`data:`))return``;t||=globalThis.location;let n=new URL(e,document.baseURI);return n.hostname!==t.hostname||n.port!==t.port||n.protocol!==t.protocol?`anonymous`:``}function lt(){let e=[],t=[];for(let n of at){let r=x.MIME_TYPES[n.substring(1)]||`video/${n.substring(1)}`;F(r)&&(e.push(n),t.includes(r)||t.push(r))}return{validVideoExtensions:e,validVideoMime:t}}var ut={name:`loadVideo`,id:`video`,extension:{type:r.LoadParser,name:`loadVideo`},test(e){if(!G||!K){let{validVideoExtensions:e,validVideoMime:t}=lt();G=e,K=t}let t=L(e,K),n=R(e,G);return t||n},async load(e,t,n){let r={...x.defaultOptions,resolution:t.data?.resolution||z(e),alphaMode:t.data?.alphaMode||await te(),...t.data},i=document.createElement(`video`),a={preload:r.autoLoad===!1?void 0:`auto`,"webkit-playsinline":r.playsinline===!1?void 0:``,playsinline:r.playsinline===!1?void 0:``,muted:r.muted===!0?``:void 0,loop:r.loop===!0?``:void 0,autoplay:r.autoPlay===!1?void 0:``};Object.keys(a).forEach(e=>{let t=a[e];t!==void 0&&i.setAttribute(e,t)}),r.muted===!0&&(i.muted=!0),ot(i,e,r.crossorigin);let o=document.createElement(`source`),s;if(r.mime)s=r.mime;else if(e.startsWith(`data:`))s=e.slice(5,e.indexOf(`;`));else if(!e.startsWith(`blob:`)){let t=e.split(`?`)[0].slice(e.lastIndexOf(`.`)+1).toLowerCase();s=x.MIME_TYPES[t]||`video/${t}`}return o.src=e,s&&(o.type=s),new Promise(a=>{let s=async()=>{let o=new x({...r,resource:i});i.removeEventListener(`canplay`,s),t.data.preload&&await st(i),a(B(o,n,e))};r.preload&&!r.autoPlay&&i.load(),i.addEventListener(`canplay`,s),i.appendChild(o)})},unload(e){e.destroy(!0)}},q={extension:{type:r.ResolveParser,name:`resolveTexture`},test:it.test,parse:e=>({resolution:parseFloat(v.RETINA_PREFIX.exec(e)?.[1]??`1`),format:e.split(`.`).pop(),src:e})},dt={extension:{type:r.ResolveParser,priority:-2,name:`resolveJson`},test:e=>v.RETINA_PREFIX.test(e)&&e.endsWith(`.json`),parse:q.parse},J=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new v,this.loader=new Ae,this.cache=S,this._backgroundLoader=new xe(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){u(`[Assets]AssetManager already initialized, did you load before calling this Assets.init()?`);return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let t=e.manifest;typeof t==`string`&&(t=await this.load(t)),this.resolver.addManifest(t)}let t=e.texturePreference?.resolution??1,n=typeof t==`number`?[t]:t,r=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:n}}),e.preferences&&this.setPreferences(e.preferences),e.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...e.loadOptions})}add(e){this.resolver.add(e)}async load(e,t){this._initialized||await this.init();let n=ee(e),r=m(e).map(e=>{if(typeof e!=`string`){let t=this.resolver.getAlias(e);return t.some(e=>!this.resolver.hasKey(e))&&this.add(e),Array.isArray(t)?t[0]:t}return this.resolver.hasKey(e)||this.add({alias:e,src:e}),e}),i=this.resolver.resolve(r),a=await this._mapLoadToResolve(i,t);return n?a[r[0]]:a}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let n=!1;typeof e==`string`&&(n=!0,e=[e]);let r=this.resolver.resolveBundle(e),i={},a=Object.keys(r),o=0,s=[],c=()=>{t?.(s.reduce((e,t)=>e+t,0)/o)},l=a.map((e,t)=>{let n=r[e],a=Object.values(n),l=[...new Set(a.flat())].reduce((e,t)=>e+(t.progressSize||1),0);return s.push(0),o+=l,this._mapLoadToResolve(n,e=>{s[t]=e*l,c()}).then(t=>{i[e]=t})});return await Promise.all(l),n?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),typeof e==`string`&&(e=[e]);let t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e==`string`&&(e=[e]);let t=this.resolver.resolveBundle(e);Object.values(t).forEach(e=>{this._backgroundLoader.add(Object.values(e))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e==`string`)return S.get(e);let t={};for(let n=0;n<e.length;n++)t[n]=S.get(e[n]);return t}async _mapLoadToResolve(e,t){let n=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;let r=await this.loader.load(n,t);this._backgroundLoader.active=!0;let i={};return n.forEach(e=>{let t=r[e.src],n=[e.src];e.alias&&n.push(...e.alias),n.forEach(e=>{i[e]=t}),S.set(n,t)}),i}async unload(e){this._initialized||await this.init();let t=m(e).map(e=>typeof e==`string`?e:e.src),n=this.resolver.resolve(t);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=m(e);let t=this.resolver.resolveBundle(e),n=Object.keys(t).map(e=>this._unloadFromResolved(t[e]));await Promise.all(n)}async _unloadFromResolved(e){let t=Object.values(e);t.forEach(e=>{S.remove(e.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(let n of e.detections)e.skipDetections||await n.test()?t=await n.add(t):e.skipDetections||(t=await n.remove(t));return t=t.filter((e,n)=>t.indexOf(e)===n),t}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(t=>t in e).forEach(n=>{t.config[n]=e[n]})})}};t.handleByList(r.LoadParser,J.loader.parsers).handleByList(r.ResolveParser,J.resolver.parsers).handleByList(r.CacheParser,J.cache.parsers).handleByList(r.DetectionParser,J.detections),t.add(Se,we,Ce,ke,Ee,De,Oe,Ne,Ie,We,qe,it,ut,be,ye,q,dt);var ft={loader:r.LoadParser,resolver:r.ResolveParser,cache:r.CacheParser,detection:r.DetectionParser};t.handle(r.Asset,e=>{let n=e.ref;Object.entries(ft).filter(([e])=>!!n[e]).forEach(([e,r])=>t.add(Object.assign(n[e],{extension:n[e].extension??r})))},e=>{let n=e.ref;Object.keys(ft).filter(e=>!!n[e]).forEach(e=>t.remove(n[e]))});var pt=class extends e{constructor(e,t){let{text:n,resolution:r,style:i,anchor:a,width:o,height:s,roundPixels:c,...l}=e;super({...l}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=t,this.text=n??``,this.style=i,this.resolution=r??null,this.allowChildren=!1,this._anchor=new d({_onUpdate:()=>{this.onViewUpdate()}}),a&&(this.anchor=a),this.roundPixels=c??!1,o!==void 0&&(this.width=o),s!==void 0&&(this.height=s)}get anchor(){return this._anchor}set anchor(e){typeof e==`number`?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){e||={},this._style?.off(`update`,this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on(`update`,this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||={},e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,t){typeof e==`object`?(t=e.height??e.width,e=e.width):t??=e,e!==void 0&&this._setWidth(e,this.bounds.width),t!==void 0&&this._setHeight(t,this.bounds.height)}containsPoint(e){let t=this.bounds.width,n=this.bounds.height,r=-t*this.anchor.x,i=0;return e.x>=r&&e.x<=r+t&&(i=-n*this.anchor.y,e.y>=i&&e.y<=i+n)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e==`boolean`?e:e?.style)&&this._style.destroy(e),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}};function mt(e,t){let n=e[0]??{};return(typeof n==`string`||e[1])&&(l(c,`use new ${t}({ text: "hi!", style }) instead`),n={text:n,style:e[1]}),n}var ht=class extends pt{constructor(...e){let t=mt(e,`Text`);super(t,ne),this.renderPipeId=`text`,t.textureStyle&&(this.textureStyle=t.textureStyle instanceof s?t.textureStyle:new s(t.textureStyle))}updateBounds(){let e=this._bounds,t=this._anchor,n=0,r=0;if(this._style.trim){let{frame:e,canvasAndContext:t}=y.getCanvasAndContext({text:this.text,style:this._style,resolution:1});y.returnCanvasAndContext(t),n=e.width,r=e.height}else{let e=re.measureText(this._text,this._style);n=e.width,r=e.height}e.minX=-t._x*n,e.maxX=e.minX+n,e.minY=-t._y*r,e.maxY=e.minY+r}};t.add(pe,me);const Y={up:!1,down:!1,left:!1,right:!1,fire:!1,special:!1,analogX:0,analogY:0};var gt={ArrowUp:`up`,w:`up`,ArrowDown:`down`,s:`down`,ArrowLeft:`left`,a:`left`,ArrowRight:`right`,d:`right`," ":`fire`,Enter:`special`};window.addEventListener(`keydown`,e=>{let t=gt[e.key];t&&typeof Y[t]==`boolean`&&(Y[t]=!0),(e.key===`ArrowLeft`||e.key===`a`)&&(Y.analogX=-1),(e.key===`ArrowRight`||e.key===`d`)&&(Y.analogX=1),(e.key===`ArrowUp`||e.key===`w`)&&(Y.analogY=-1),(e.key===`ArrowDown`||e.key===`s`)&&(Y.analogY=1)}),window.addEventListener(`keyup`,e=>{let t=gt[e.key];t&&typeof Y[t]==`boolean`&&(Y[t]=!1),(e.key===`ArrowLeft`||e.key===`a`||e.key===`ArrowRight`||e.key===`d`)&&(Y.analogX=0),(e.key===`ArrowUp`||e.key===`w`||e.key===`ArrowDown`||e.key===`s`)&&(Y.analogY=0)});function _t(){let e=navigator.getGamepads();if(!e)return;let t=e[0];if(!t)return;let n=t.axes[0]||0,r=t.axes[1]||0,i=Math.sqrt(n*n+r*r);i<.2?(n=0,r=0):i>1&&(n/=i,r/=i),Y.analogX=n,Y.analogY=r,Y.up=t.buttons[12]?.pressed||r<-.5,Y.down=t.buttons[13]?.pressed||r>.5,Y.left=t.buttons[14]?.pressed||n<-.5,Y.right=t.buttons[15]?.pressed||n>.5,Y.fire=t.buttons[0]?.pressed||!1,Y.special=t.buttons[1]?.pressed||!1}setInterval(_t,16);var vt=class extends i{sprite;invincibleSeconds=0;constructor(e){super(),this.sprite=new p(e),this.sprite.anchor.set(.5);let t=128/this.sprite.texture.width;this.sprite.scale.set(t),this.sprite.x=1920/2,this.sprite.y=1080/5*4,this.addChild(this.sprite)}update(e){let t=8*e,n=0,r=0;Y.analogX!==0||Y.analogY!==0?(n=Y.analogX*t,r=Y.analogY*t):(Y.left&&(n-=t),Y.right&&(n+=t),Y.up&&(r-=t),Y.down&&(r+=t)),this.sprite.x+=n,this.sprite.y+=r;let i=this.sprite.width/2,a=this.sprite.height/2;if(this.sprite.x=Math.max(i,Math.min(1920-i,this.sprite.x)),this.sprite.y=Math.max(a,Math.min(1080-a,this.sprite.y)),this.invincibleSeconds>0){let t=e/60;this.invincibleSeconds=Math.max(0,this.invincibleSeconds-t);let n=Math.floor(this.invincibleSeconds*5)%2==0;this.sprite.alpha=n?.5:1}else this.sprite.alpha=1}startInvincible(e){this.invincibleSeconds=Math.max(0,e)}get isInvincible(){return this.invincibleSeconds>0}reset(e=1920/2,t=1080/5*4){this.sprite.x=e,this.sprite.y=t,this.invincibleSeconds=0,this.sprite.alpha=1}},yt=class extends i{text;constructor(){super(),this.text=new ht(``,{fill:`#fff`,fontSize:18,fontFamily:`monospace`,stroke:`#000`,padding:8,align:`right`}),this.addChild(this.text)}update(e,t){this.text.text=`Scale: ${e.toFixed(3)}\nFPS: ${Math.round(t)}`,this.text.x=1910,this.text.y=10,this.text.anchor.set(1,0)}},bt=class extends i{sprites=[];texture;count;constructor(e,t=5){super(),this.texture=e,this.count=t,this.createSprites(t)}createSprites(e){this.removeChildren(),this.sprites=[];let t=32/this.texture.width;for(let n=0;n<e;n++){let e=new p(this.texture);e.anchor.set(.5),e.scale.set(t);let r=e.width/2,i=e.height/2;e.x=10+r+n*(e.width+8),e.y=1070-i,this.addChild(e),this.sprites.push(e)}}setLives(e){this.count=Math.max(0,e),this.createSprites(this.count)}getLives(){return this.count}},xt=class extends i{graphics;speed;movementType;timeAlive=0;startX;screenHeight;hp;constructor(e,t,n,r=16711680,i=`straight`){super(),this.speed=2,this.movementType=i,this.startX=e,this.screenHeight=n,this.hp=3,this.graphics=new ie,this.graphics.beginFill(r),this.graphics.drawRect(-32,-32,64,64),this.graphics.endFill(),this.position.set(e,t),this.addChild(this.graphics)}update(e){return this.timeAlive+=e,this.y+=this.speed*e,this.movementType===`sine`&&(this.x=this.startX+Math.sin(this.timeAlive*.1)*100),this.y>this.screenHeight+64||this.hp<=0}takeDamage(e){this.hp-=e}},St=class extends i{gfx;speed;damage;constructor(e,t,n=600,r=1){super(),this.speed=n,this.damage=r,this.gfx=new ie,this.gfx.beginFill(16777215),this.gfx.drawRect(-4,-8,8,16),this.gfx.endFill(),this.addChild(this.gfx),this.position.set(e,t)}update(e){let t=e/60;return this.y-=this.speed*t,this.y<-32}},X=new O;await X.init({background:0,resizeTo:window}),X.ticker.maxFPS=60;var Z=1920,Q=1080;function Ct(){let e=window.innerWidth/Z,t=window.innerHeight/Q,n=Math.min(e,t);X.stage.scale.set(n),X.stage.position.set((window.innerWidth-Z*n)/2,(window.innerHeight-Q*n)/2)}window.addEventListener(`resize`,()=>{X.renderer.resize(window.innerWidth,window.innerHeight),Ct()});var $=document.querySelector(`#app`);$&&($.innerHTML=``,$.appendChild(X.canvas));async function wt(){let e=await J.load(`/art/thunder.jpg`),t=new vt(e),n=new yt,r=new bt(e,5);X.stage.addChild(t),X.stage.addChild(n),X.stage.addChild(r);let i=document.createElement(`div`);i.id=`game-over-overlay`,i.style.position=`fixed`,i.style.left=`0`,i.style.top=`0`,i.style.width=`100vw`,i.style.height=`100vh`,i.style.display=`none`,i.style.alignItems=`center`,i.style.justifyContent=`center`,i.style.background=`rgba(0,0,0,0.6)`,i.style.zIndex=`2000`;let a=document.createElement(`div`);a.style.background=`#111`,a.style.color=`#fff`,a.style.padding=`24px`,a.style.borderRadius=`8px`,a.style.textAlign=`center`,a.style.minWidth=`320px`;let o=document.createElement(`div`);o.innerText=`Game Over`,o.style.fontSize=`1.6rem`,o.style.marginBottom=`12px`,a.appendChild(o);let s=document.createElement(`button`);s.innerText=`New Game`,s.style.padding=`8px 16px`,s.style.fontSize=`1rem`,s.style.cursor=`pointer`,a.appendChild(s),i.appendChild(a),document.body.appendChild(i);function c(){i.style.display=`none`,X.ticker.start()}s.addEventListener(`click`,()=>{for(let e of d)X.stage.removeChild(e);d.length=0,r.setLives(5),t.reset(),c()}),Ct();let l=performance.now(),u=60,d=[],f=0,p=[],m=0;X.ticker.add(e=>{if(_t(),t.update(e.deltaTime),f+=e.deltaTime,f>=120){f=0;let e=Math.random()*Z,t=[16711680,65280,255,16776960,16711935,65535],n=t[Math.floor(Math.random()*t.length)],r=new xt(e,-64,Q,n,Math.random()>.5?`straight`:`sine`);d.push(r),X.stage.addChild(r)}for(let n=d.length-1;n>=0;n--){let a=d[n].update(e.deltaTime),o=t.getBounds(),s=d[n].getBounds();if(o.x<s.x+s.width&&o.x+o.width>s.x&&o.y<s.y+s.height&&o.y+o.height>s.y&&!t.isInvincible){let e=Math.max(0,r.getLives()-1);r.setLives(e),t.startInvincible(2),X.stage.removeChild(d[n]),d.splice(n,1),e<=0&&(i.style.display=`flex`,X.ticker.stop());continue}a&&(X.stage.removeChild(d[n]),d.splice(n,1))}let a=e.deltaTime/60;if(Y.fire)for(m-=a;m<=0;){let e=t.sprite.x,n=new St(e,t.sprite.y-t.sprite.height/2-8,900,1);p.push(n),X.stage.addChild(n),m+=.06666666666666667}else m<0&&(m=0);for(let t=p.length-1;t>=0;t--){let n=p[t];if(n.update(e.deltaTime)){X.stage.removeChild(n),p.splice(t,1);continue}for(let e=d.length-1;e>=0;e--){let r=d[e],i=n.getBounds(),a=r.getBounds();if(i.x<a.x+a.width&&i.x+i.width>a.x&&i.y<a.y+a.height&&i.y+i.height>a.y){r.takeDamage(n.damage),X.stage.removeChild(n),p.splice(t,1),r.hp<=0&&(X.stage.removeChild(r),d.splice(e,1));break}}}let o=performance.now();u=1e3/(o-l),l=o;let s=X.stage.scale.x;n.update(s,u)})}wt();